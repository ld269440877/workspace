# <font color=red>excel 介绍与基本图形可视化</font>

## 课前准备

- 安装office 2019版本。
- 了解excel中各作图功能区域，了解各功能模块的功能和操作方式。
    - <font color=red><b>图表</b></font>选项功能区（双击绘制的图形）
        - 填充与线条
        - 效果
        - 大小与属性
        - 坐标轴选项（双击坐标轴的文本）
    - <font color=red><b>文本</b></font>选项功能区(双击绘制图形的文本)
        - 文本填充与轮廓
        - 文字效果
        - 文本框
- 回忆生活和工作中遇到的图形主要有哪几类，分别可以用哪些图形来分析和展示这些数据问题。

## 课堂主题

本节主要通过excel常见图形可视化的讲解，带大家总结学习各可视化图形特征、适用场景及作图方法；譬如条形图、柱状图、折线图、散点图、饼图、环形图、箱线图等。

## 课堂目标

- 掌握各类可视化图形的<font color=orange>特征和信息</font>展示方式。
- 掌握excel作图功能区和相应操作实现。
- 掌握图形制作的基本流程和方法。
    - <font color=red><b>图表的选择</b></font>：确定要表达的信息→确定相对关系→选择图表形式。

        - 从多个维度观察数据，明确要表达或分析的主题。
        - 明确要表达的数据之间的关系（突出重点）。
        - 梳理数据关系，并根据数据特征、数据关系选择合适的可视化图表。

    - <font color=red><b>可视化实现</b></font>：选择数据，完成基本图形→调整大小比例→润色（颜色、网格线、背景色）→
      增加图例坐标轴和标题。
    
      黄金分割比$\frac{\sqrt{5}-1}{2}=0.618$
- 了解工作中应用案例和可视化展示方案。

## 柱状图与条形图(每一类中有多少)

### 图形简介

- <font color=red>柱状图</font>是使用垂直的柱子显示类别之间的数值比较，其中一个轴（横轴）表示需要对比的分类维度，另一个轴（纵轴）表示相应维度下的数值。
- <font color=red>条形图</font>是柱状图的转置，工作中柱状图应用居多。

### 基础用法

- 柱状图或条形图描述的是分类数据，回答的是每一类中“有多少？”的问题。
- 此外柱状图也可以用于展示时间序列数据； 
- 需要注意的是，当柱状图显示的分类很多时会导致分类名称重叠等情况，可以考虑用条形图代替。
> 柱状图主要展示对比差异，此外如果是时间序列可以看柱状图的趋势。
- 柱状图常用的几类图形：
  1. 单一柱状图：反映单一类别数据对比，或时序数据趋势
  2. 并列柱状图：展示两类及以上数据的对比，也可展示随时间的变化趋势。
  3. 堆叠柱状图(不建议分类超过5类，超过时可以选择最重要的分类，不重要归为"其他"处理)。
      1. 普通堆积柱状图：展示数据的内部结构分布。
      2. 百分比堆积柱状图：展示整体内部的相对分布。

### 常用图形

![柱状图与条形图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/柱状图与条形图.png "柱状图与条形图")

### 2019小米Q1电脑销量排名（柱状图）

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/2019小米Q1电脑销量排名源数据.png)

1. 选择字段为2019Q1的数据
2. 插入柱状图
3. 单击图表标题2019Q1旁的空白处-设置大小属性9:15
4. 在图表上右击-选择数据-水平（分类）轴标签-编辑-轴标签区域
5. 柱子宽度大于等于中间空白区域-单击柱子-系列选项-间隙宽度100%
6. 单击柱子-添加数据标签-添加数据标签，添加数据标注； 单击数据标签-标签选项，数字-标签包括，标签位置
7. 单击柱子-填充与线条-纯色填充-颜色-橙色
8. 右击-更改图标类型-条形图

![修改轴标签](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/初级小米Q1销量柱状图修改轴标签.png "修改轴标签")

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/初级小米Q1销量柱状图修改轴标签后.png)

### 小米电脑各季度销量均低于联想电脑（簇状柱状图）

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/小米电脑各季度销量均低于联想电脑-源数据.png)

1. 选择字段和对应的数据
2. 插入簇状柱状图
3. 调整图形大小9:15
4. 单击柱子-添加数据标签-添加数据标签，添加数据标注； 单击数据标签-标签选项，数字-标签包括，标签位置-数据标签-字体为白色（选择模板后部分不能添加标签）
5. 单击图表-图表设计-选择合适的图表模板

### 小米电脑各季度销量与市场大盘对比分布（堆积柱状图）

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/小米电脑各季度销量与市场大盘对比分布堆积柱状图-源数据.png)

1. 选择字段和对应的数据
2. 插入堆积柱状图

### 各品牌电脑堆积百分比图（百分比堆积柱状图）

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/各品牌电脑堆积百分比图-源数据.png)

1. 选择字段和对应的数据
2. 插入百分比堆积柱状图
3. 调整图形大小9:15
4. 单击柱子-添加数据标签-添加数据标签，添加数据标注； 单击数据标签-标签选项，数字-标签包括，标签位置-数据标签-字体为白色
5. 单击图表-图表设计-选择合适的图表模板

## 折线图和面积图

### 图形简介

<font color=red>折线图</font>用于显示数据在一个连续的时间间隔或时间跨度上的变化，它的特点是反映<font color=orange>变量随时间或有序类别的变化趋势</font>。
2.2 基础用法：
- 折线图中，数据是递增还是递减、增减的速率、增减的规律（周期性、螺旋性、随机性等）、峰值、凹值等特征都可以被清晰地反映。
- 折线图常用来分析数据随有序变量（时间）的变化趋势，也可用来分析多组数据随时间变化的相互作用和相互影响。例如可用来分析某类商品或是某几类相关商品随时间变化的销售情况，进而预测未来的销售业绩、分析GDP随年份的变化趋势等。
- 在折线图中，一般水平轴（横轴）用来表示时间或有序维度的推移，并且间隔相同；而垂直轴（纵轴）代表不同时刻和维度的数据的大小。
>特点：可以反映变量的周期性、趋势性、季节性、随机性等，通过折线可以对变量的趋势有全面的认知和预判。
- 折线图常用几类图形：
  1. 折线图
  2. 点线图
  3. 曲线图
  4. 变体面积图
     1. 普通堆积面积图：反映整体和整体中各部分随时间的变化趋势。
     2. 百分比堆积面积图：分析整体中各部分随着时间的占比变化趋势（类比堆积百分比柱状图）。

### 常用图形

![折线图和面积图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/折线图和面积图.png "折线图和面积图")

### 天猫APP各月份的交易额变化折线图

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/天猫APP%20A%20各月份的交易额变化折线图-源数据.png)

### 市场整体交易额增长来源于拼多多-堆积面积图

1. 选择字段和对应的数据
2. 插入堆积折线图
3. 单击最后一个数据点-添加数据标签-添加数据标签，添加数据标注； 单击数据标签-标签选项，数字-标签包括，标签位置-数据标签-字体为白色
4. 右击图表-更改图标类型-面积图-堆积面积图

### 天猫APP市占交易额下降严重-百分比堆积面积图

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/天猫APP市占交易额下降严重-百分比堆积面积图源数据.png)

1. 选择字段和对应的数据
2. 插入百分比堆积折线图
3. 单击最后一个数据点-添加数据标签-添加数据标签，添加数据标注； 单击数据标签-标签选项，数字-标签包括，标签位置-数据标签-字体为白色
4. 右击图表-更改图标类型-面积图-百分比堆积面积图


## 饼图与环形图

### 简介
- 饼图或环形图用于显示分类数据中各类占整体的比例，用饼图或环形图的面积或弧长展示各类别占整体的多少，更多的用于展示静态分类数据(与时间序列数据区别)分布。
> 注意只能用各分类加总等于整体的数据类型，对于去重的数据不适用。

### 基础用法：

有饼图、环形图、二维饼图等多种类型，用饼图的面积或圆心角度大小代表相应的分类数据的数值大小。

>  饼图和环形图的主要缺点
>- 饼图不适用于多分类的数据，原则上一张饼图不可多于 6个分类，因为随着分类的增多，每个切片就会变小，最后导致大小区分不明显，每个切片看上去都差不多大小，这样会失去使用饼图的意义。所以饼图不适合分类很多的情况。
>- 相比于具备同样功能的其他图表（比如百分比柱状图、环图），饼图需要占据更大的画布空间。
>- 很难进行多个饼图之间的数值比较。

> 饼图和环形图小技巧
>- 超过6种的分类将不重要的归为“其他”一类。
>- 最重要的类别放在12点钟方向。
>- 同等重要就按照从大到小排列。
>- 环形图中间是空的，可以放置标签，整体数据、平均数值或其他内容等，其信息表达方式与饼图类似。

### 常用图形

![饼图和环形图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/饼图和环形图.png "饼图和环形图")

![复合饼图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/复合饼图.png "复合饼图")

### 小米电脑市仅为16%（扇形图）

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/小米电脑市仅为16-扇形图源数据.png)
1. 选择字段和对应的数据
2. 插入饼图
3. 右击图表-添加数据标签
4. 单击数据标签-标签选项-标签包括，标签位置-类别名称，百分比，数据标签外
5. 目标扇形小米放在12点钟方向-单击图表-系列选项-第一扇区起始角度，点分离
6. 拖拽突出目标扇形-点分离
7. 单击图表-更改图标类型-环形图-环形中心添加艺术字总量3555
8. 更改图表类型-子母饼图-系列选项-第二绘图区中的值（扇形个数），间隙宽度，第二绘图区大小

## 散点图与气泡图

### 简介
<font color=red>散点图</font>用来展示或探索变量之间的变化关系，也经常用来展示数据点在直角坐标系平面上的分布，散点图也可表示因变量随自变量的变化情况，通常在做拟合、回归时会先做散点图分析确定相应的拟合函数。
<font color=red>气泡图</font>可用于展示三个变量之间的关系也可用于展示两个变量之间的关系。它与散点图类似，绘制时将 一个变量放在横轴，另一个变量放在纵轴，而第三个变量则用气泡的大小来展示（<font color=orange>气泡的大小是用气泡的面积进行映射的，非半径</font>）；**两变量时**，分类变量放在横轴，数值变量放在纵轴，气泡的大小和高度代表数值变量大小；气泡图也可用于分析数据之间的相关性。
### 基础用法：
<font color=red>散点图</font>一般用于研究两变量的关系，对应的数据形式为(x, y)，
<font color=red>气泡图</font>除了具备散点图的功能外，可以用气泡的面积映射到第三个维度数据，对应的数据形式为(x, y,z)，散点图多用于研究数据的分布规律和相关性，并不侧重描述具体每个数据点的取值。
### 常用图形

![散点图与气泡图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/散点图与气泡图.png "散点图与气泡图")

### 应用场景：

1. 关系数据探索（譬如年龄与平均手机使用时长散点图）。
2. 多变量映射，用于分析数据的相关性(譬如上面营销费用与DAU的关系)。
3. 和地图的结合使用，用于在地图上展示不同地区某些变量的度量大小等情况（较多）。

### 营销活动与DAU散点图

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/营销活动与DAU散点图-源数据.png)

观察营销活动与观察新增用户DAU
1. 选择字段和对应的数据
2. 插入散点图
3. 单击图表-设置图表区格式-大小属性9:15
4. 单击图表-图表工具-设计-坐标轴，坐标轴标题，图标标题，数据标签，数据表，误差线，网格线，图例，线条，趋势线，涨/跌柱线
5. 单击图表-图表工具-设计-添加图表元素-坐标轴标题-主要横坐标轴，主要纵坐标轴
6. 单击图表-图表工具-设计-添加图表元素-趋势线-无，线性，指数，线性预测，
移动平均，其他趋势线选项

### 各项费用投入与新增MAU都呈现正相关-气泡图

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/各项费用投入与新增MAU都呈现正相关-气泡图源数据.png)

观察新增用户DAU与其他两个变量之间的关系

## 箱线图

### 简介

基础箱线图，又称盒须图、盒式图或箱型图，是一种用作显示一组数据分布情况的<font color=red>统计图</font>。

### 基础用法

- 如果一个数据集中包含了一个或多个分类变量，同时分类变量对应的多个连续变量，那么可以用箱线图展示连续变量会如何随着分类变量的变化而变化，也可以展示不同分类变量下的数据分布结构。

- 箱线图用5个数字对分布进行概括，即一组数据的最大值、最小值、中位数、下四分位数和上四分位数。对于数据集中的异常值，通常会以单独的点绘制（异常值一般为较大或较小的个别值，一般为上下四分位点的1.5QR Inter-Quartile Range内距,）。

- 箱形图多用于数值统计，虽然相比于直方图和密度曲线较原始简单，但它不需要占据过多的画布空间，空间利用率高，非常适用于多组数据分布情况的比较。

![箱线图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/箱线图.png "箱线图")

![箱线图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/常用图形-箱线图.png "箱线图")

### 应用场景

1. 对比各组数据的分布情况。
2. 检测数据中的异常点或者离群值。

### 各季度华为电脑销量分布最为集中-箱线图

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/各季度华为电脑销量分布最为集中-箱线图源数据.png)

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/箱线图设置坐标轴格式-各箱线图间的间隙宽度.png)

![](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/箱线图添加图表元素-图例.png)

1. 纵坐标看各品牌销量-华为电脑销量最低，联想电脑销量最高
2. 横坐标柱子越矮-销售量越集中-华为电脑销量最集中

## 总结

1. 上市互联网公司通用指标：
1. 交易额&订单量(加总)
2. DAU (Daily Active User) &MAU (Monthly Active User)去重
3. MTU(Monthly transaction user) &ATU(Annual transaction user) 去重，

### 数据类型总结

1. 趋势型：变量的变化趋势，常见于时间序列数据。
2. 比例型：总体上各内部分布的比例。
3. 对比型：多组数据之间的对比，多用于分类数据或时间序列数据的对比。
4. 分布型：数据之间的分布情况，譬如单变量的分布（离散程度、集中趋势、偏峰度等）和多变量的关系分布。
5. 关联型：数据之间的互相关系，譬如分层关系、联结关系、包含关系等。
6. 地理型数据：多和地图和图表结合使用。

### 可视化过程中要注意的

1. 可视化重要的不是可视化本身，而是如何通过恰当可视化展示传递出来数据信息。
2. 选择何种图形依赖于数据形式和分析者要传达出来的观点。
3. 可视化过程中遵循少量原则，一个图形中所表达的信息不要多于三部分。

## 作业

1. 将课件所讲到的几类excel图形动手重现，通过练习提升对图形的操作熟练程度；切忌眼高手低，一定要上手操作才会有真正的进步。
2. 对照今天所讲五类图形的特点和信息展现方式，思考三个平时自己遇到的数据问题，哪些是可以用今天掌握的图形来分析和展示，尝试做出来。

# <font color=red>excel高级图形实现</font>
# TODO excel高级图形实现有笔记copy但是还没有听课做详细的笔记
## 课堂主题

通过excel图形的深化学习，带领大家掌握各类可视化图形在工作中的适用场景和常规做法；并掌握相对高级图形，譬如雷达图、组合图、瀑布图、漏斗图等各类图形的信息展示形式和具体实现步骤。

## 课堂目标

- 了解各类不同图形的展示特征和信息表达形式。
- 了解工作中实际案例和可视化展示方案

## 箱线图

### 简介

基础箱线图，又称盒须图、盒式图或箱型图，是一种用作显示一组数据分布情况的统计图。

### 基础用法

如果一个数据集中包含了一个或多个分类变量，同时分类变量对应的多个连续变量，那么可以用箱线图展示连续变量会如何随着分类变量的变化而变化，也可以展示不同分类变量下的数据结构。

箱线图用5个数字对分布进行概括，即一组数据的最大值、最小值、中位数、下四分位数和上四分位数。对于数据集中的异常值，通常会以单独的点的形式绘制（异常值一般为较大或较小的个别值，一般为上下四分位点的1.5QR Inter-Quartile Range内距,）。
箱形图可以水平或横置进行对组分类变量的对比。

箱形图多用于数值统计，虽然相比于直方图和密度曲线较原始简单，但它不需要占据过多的画布空间，空间利用率高，非常适用于多组数据分布情况的比较。

![箱线图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/箱线图.png "箱线图")

### 常用图形

![箱线图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/各品牌电脑销量分布箱线图.png "箱线图")

## 雷达图

### 简介

将多个维度的数据映射到坐标轴上，这些坐标轴起始于同一个圆心点，通常结束于圆周边缘，像这样将同一组点用线连接起来的图形称为雷达图。它可以将多维数据进行展示和对比，但点的相对位置和坐标轴之间的夹角是没有任何信息的。

每一个维度的数据都分别对应一个坐标轴，这些坐标轴具有相同的圆心，以相同的间距沿径向排列，并且各坐标轴的刻度相同。连接各坐标轴的网格线通常只作为辅助元素。将各坐标轴上的数据点用线连接起来就形成了一个多边形，这些坐标轴、点、线、多边形是雷达图不可缺少的元素。

### 基础用法

> 雷达图的主要缺点：
>- 不能用于展示过多的变量。
>- 展示变量的信息必须标准化到同一个度量单位下。

### 常用图形

![雷达图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/能力模型雷达图.png "雷达图")

> 对于第二张的面积雷达图的实现步骤：
>- 第一步：先做成二维面积图(调节好横纵坐标和网格)
>- 第二步：将最外层的填充改为纯色填充，并且透明度改为100%，也就是纯透明
>- 第三步：选中最外层面积的边框，将边框改为实线并加粗更改颜色
>- 第四步：右键将面积图改为面积雷达图，调节雷达图纵坐标为合适宽度即可

### 应用场景

1. 更多用于展示多分类型的数据，在同一数据类型下的展示或对比情况。
2. 多变量映射，用于分析数据的相关性(城镇消费水平在同一指数下的消费水平是否相关)

## 组合图

### 简介

组合图是为了方便展示多种信息，把多种信息用不同的图形展示在一张图上，从而更直观的实现各种信 息之间的对比和相关性的探索。

### 基础用法

1、常用的有柱状图的和折线图的组合，柱状图和柱状图的组合等。
2、遵循少量原则，组合图一般真是信息不要多于两个，否则会导致看起来比较混乱，信息表达不集中。

### 常用图形

![组合图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/组合图-柱柱-柱折线图.png "组合图")

## 瀑布图

### 简介

瀑布图有助于理解依次引入正值或负值的累积效应变化。瀑布图也被称为飞行砖图或马里奥图，因为看起来像悬挂在空中的砖头。

### 常用图形

![瀑布图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/瀑布图.png "瀑布图")

![甘特图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/甘特图.png "甘特图")

## 漏斗图

### 简介

用于业务流程**规范、周期长、环节多**的单流程分析，通过漏斗各环节业务数据的比较能够直观地发现和说明问题所在的环节，进而支持业务策略改进和后期的新策略的评估。

漏斗图用梯形面积表示某个环节业务量与上一个环节之间的差异。漏斗图从上到下，有逻辑上的顺序关系，展示了随业务流程的推进业务目标完成的状况。

### 基础用法

常适用于工作中的流量分析、用户行为分析、渠道对比分析等找出运营中的问题环节从而来调整运营策略，提升运营效率。

### 常用图形

![漏斗图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/用户行为漏斗图.png "漏斗图")

## 旭日图

### 简介

旭日图（Sunburst Chart）是一种现代饼图，它超越传统的饼图和环图，能表达清晰的层级和归属关系，以父子层次结构来显示数据构成情况。

在旭日图中，离圆点越近表示级别越高，相邻两层中是内层包含外层的关系。

### 基础用法

旭日图可以更细的溯源和分析数据，真正了解数据的具体构成。

### 常用图形

![旭日图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/各品类销售分布-旭日图.png "旭日图")

## 树状图

### 简介

树状图采用矩形表示层次结构里的节点，父子节点之间的层次关系用矩形之间的相互嵌套隐喻来表达。

从根节点开始，屏幕空间根据相应的子节点数目被分为多个矩形，矩形的面积大小通常对应节点的属性。每个矩形又按照相应节点进行分割，直到叶子节点为止。

### 用法

树状图的好处在于，相比起传统的树形结构图，其能更有效得利用空间，并且拥有展示占比的功能。树状图的缺点在于，当分类占比太小的时候文本会变得很难排布。表达的不够直观、明确。
### 常用图形

![树状图](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/树状图.png "树状图")

## 表格图形

### 简介

表格图形是excel表格和图形的结合，通过数据和图形的组合来寻找规律发现问题。

### 常用图形

- mini图
- 热力图
- 柱状数据条

![表格图形](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/表格图形.png "表格图形")

## 总结

- 雷达图主要用于多种分类型数据，用来展示和对比不同维度下的数据分布特征。
- 组合图把多维度信息放在一张图中展示，希望达到对比、相关性分析从而突出结论的目的。
- 瀑布图更多展示汇总数据内部的结构变化，更多用于可以直接加减汇总的数据。
- 漏斗图用来展示多环节、单流程的单向分析，通过漏斗各环节业务数据的比较能够直观- 地发现和说明问题所在的业务环节，进而支持业务运营调整。
- 矩形图和旭日图展示数据结构和各节点数据的大小。
- 表格图形可以快速准确的找到数据趋势的变化规律。

## 不同类型数据的适用场景对比

![不同类型数据的适用场景对比](https://raw.githubusercontent.com/ld269440877/images/master/ExcelVisualization/不同类型数据的适用场景对比.png "不同类型数据的适用场景对比")

## 作业

1. 把给到的用户数据依据交易的渠道数进行透视。
2. 通过表格图形中的柱状数据条观察各渠道数下的用户增长变化，并猜测可能的原因有哪些。
3. 通过计算出的同环比数据和具体的用户数的组合图寻找各类用户的增长规律。
4. 思考从给到的数据还可以通过哪些图形的探索实现信息挖掘，如果需要继续向下探索，还可能用到哪些数据，如果拿到这些数据如何进行可视化分析？利用这些数据能否完整讲述一个故事？
5. 从第二份数据中思考用何种图形能找出用户的转化规律。








